# PLAN TÉCNICO - Botones de Sonidos en Pantalla ACUSE

## Descripción de la Funcionalidad

El usuario quiere añadir 3 botones sobre `players-grid-container` y bajo `pedorro-message` (si está visible) en la pantalla de ACUSE. Los botones serán:

1. **LIMPIO** (verde) - Reproduce "neutral.mp3"
2. **PEDITO** (naranja) - Reproduce el pedito de esa ronda
3. **PEDORRO** (rojo) - Reproduce el pedorro de esa ronda

## Archivos y Funciones que Deben Cambiarse

### Archivos HTML
- `web/index.html` - Añadir los 3 botones en la pantalla de ACUSE

### Archivos CSS
- `web/styles.css` - Estilos para los 3 botones con colores específicos

### Archivos JavaScript
- `web/script.js` - Modificar `renderAcuseScreen()` para añadir los botones y sus event listeners

## Algoritmo de Implementación

### Fase 1: Modificación del HTML
1. Añadir contenedor de botones de sonidos entre `pedorro-message` y `players-grid-container`
2. Crear 3 botones con IDs únicos: `limpiar-btn`, `pedito-btn`, `pedorro-btn`
3. Aplicar clases CSS para colores: verde, naranja, rojo respectivamente

### Fase 2: Estilos CSS
1. Crear estilos para `.sound-buttons-container`
2. Estilos específicos para cada botón con colores del PRODUCT_BRIEF:
   - LIMPIO: Verde (#4CAF50)
   - PEDITO: Naranja (#FF9800) 
   - PEDORRO: Rojo (#F44336)
3. Diseño responsive y consistente con la temática marrón existente

### Fase 3: Lógica JavaScript
1. Modificar `renderAcuseScreen()` para crear y configurar los botones
2. Implementar event listeners para cada botón:
   - `limpiar-btn`: Reproduce "neutral.mp3" usando `playAudio()`
   - `pedito-btn`: Obtiene pedito de Firebase y reproduce `pedito-{valor}.mp3`
   - `pedorro-btn`: Obtiene pedorro de Firebase y reproduce `pedorro-{valor}.mp3`
3. Manejo de errores si falla la reproducción de audio

#### Detalles de Implementación de Sonidos:
- **LIMPIO**: Siempre reproduce "neutral.mp3" (sin consulta a Firebase)
- **PEDITO**: 
  - Obtiene `gameRoles.peditos` desde `getGameRoles()`
  - Toma el primer elemento del array: `gameRoles.peditos[0]`
  - Obtiene `nextSounds[primerPedito]` desde `getNextSounds()`
  - Reproduce `pedito-{valor}.mp3`
- **PEDORRO**:
  - Obtiene `gameRoles.pedorro` desde `getGameRoles()`
  - Reproduce directamente `pedorro-{valor}.mp3`

## Detalles Técnicos

### Posicionamiento de Botones
- Los botones se posicionan **sobre** `players-grid-container`
- Los botones se posicionan **bajo** `pedorro-message` (solo si está visible)
- Layout horizontal con espaciado uniforme entre botones

### Sistema de Audio
- Usar función `playAudio()` existente del módulo `web/audio.js`
- Obtener valores de pedito/pedorro desde Firebase usando `getGameRoles()` y `getNextSounds()`
- **LIMPIO**: Reproduce "neutral.mp3" directamente
- **PEDITO**: Obtiene `peditos[0]` y busca en `nextSounds` para obtener número de sonido
- **PEDORRO**: Obtiene valor directo de `pedorro` para reproducir `pedorro-{valor}.mp3`
- Reproducción inmediata al hacer click (delay = 0)

### Manejo de Estados
- Los botones están siempre disponibles en la pantalla ACUSE
- No dependen del estado de acusaciones del usuario
- Funcionan independientemente del botón ACUSAR

### Responsive Design
- Botones se adaptan a diferentes tamaños de pantalla
- Mantienen proporciones y espaciado en dispositivos móviles
- Consistente con el diseño existente de la aplicación

## Integración con Sistema Existente

### Firebase
- Usar `getGameRoles(gameState.gameCode)` para obtener `peditos` y `pedorro` actuales
- Usar `getNextSounds(gameState.gameCode)` para obtener el diccionario de sonidos
- **Estructura de datos**:
  - `peditos`: Array de números de jugadores (ej: [2, 3])
  - `pedorro`: Número del jugador (ej: 1)
  - `nextSounds`: Diccionario `{jugador: numero_sonido}` (ej: {2: 3, 3: 3, 1: 1})
- No modificar estructura de datos existente
- Solo lectura de datos para reproducción de sonidos

### Audio
- Integrar con sistema de audio existente (`playAudio()`)
- Mantener compatibilidad con iOS 18
- No crear nuevos contextos de audio

### Estado del Juego
- Los botones no modifican el estado del juego
- Solo reproducen sonidos para referencia del usuario
- Funcionalidad independiente del flujo principal de acusaciones

## Consideraciones de UX

### Feedback Visual
- Botones con colores intuitivos (verde=limpio, naranja=pedito, rojo=pedorro)
- Hover effects consistentes con otros botones de la aplicación
- Estados activos/inactivos claros

### Accesibilidad
- Texto descriptivo en cada botón
- Contraste adecuado entre texto y fondo
- Tamaños de botón apropiados para dispositivos táctiles

### Consistencia
- Mantener paleta de colores oficial del PRODUCT_BRIEF
- Estilos coherentes con botones existentes
- Espaciado y tipografía consistentes
